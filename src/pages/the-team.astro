---
import Layout from '../layouts/Layout.astro'
import Section from '../components/ui/Section.astro'
import Row from '../components/ui/Row.astro'
import Col from '../components/ui/Col.astro'
import { Icon } from 'astro-icon/components'
import Button from '../components/ui/Button.astro'

// Import team data
import teamData from '../data/json-files/team.json'

const SEO = {
	title: 'Meet the Team | Activate Your Voice',
	description: 'Meet Janet Schofield and the professional team at Activate Your Voice. Over 30 years of experience in speech and drama teaching.'
}
---

<Layout title={SEO.title} description={SEO.description}>
	<!-- Hero Section -->
	<div style="position:relative;width:100vw;max-width:100%;overflow:hidden;margin-bottom:0.75rem;height:320px;">
		<img src="/team.jpg" alt="Team banner" style="width:100%;height:100%;object-fit:cover;object-position:center;" />
		<div style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(229,231,235,0.5);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);"></div>
		<div style="position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem;">
			<h1 class="text-4xl lg:text-6xl font-bold text-neutral-900 text-center mb-4">Meet the <span class="text-primary-500">team</span></h1>
			<p class="text-lg lg:text-xl text-neutral-700 text-center max-w-2xl leading-relaxed">All our lessons and courses are tailored to inspire and motivate you, as well as giving you confidence. We will provide the teaching you need to achieve your goals. </p>
		</div>
	</div>

	<!-- Team Profiles Section -->
	<Section id="team-profiles" padding="bottom">
		{teamData.teamMembers.map((member, index) => (
			<Row classes={index > 0 ? "mt-8 lg:mt-12" : ""}>
				<Col span="12">
					<div class="profile-card bg-white dark:bg-neutral-800 rounded-2xl shadow-xl shadow-neutral-200/50 dark:shadow-black/20 overflow-hidden border border-neutral-100 dark:border-neutral-700" data-cms-bind={`teamMembers.${index}`}>
						<div class="flex flex-col lg:flex-row lg:items-center">
							<!-- Image Side -->
							<div class="lg:w-2/5 p-8 lg:p-12">
								<img 
									src={member.image}
									alt={member.imageAlt}
									class="w-full h-auto rounded-xl shadow-lg border border-neutral-100 dark:border-neutral-700 object-cover"
									data-cms-image={`teamMembers.${index}.image`}
								/>
							</div>
							
							<!-- Content Side -->
							<div class="lg:w-3/5 p-8 lg:p-12 lg:pl-0">
								<div class="mb-8">
									<h2 class="text-3xl lg:text-4xl font-bold text-neutral-900 dark:text-white" data-cms-bind={`teamMembers.${index}.name`}>{member.name}</h2>
								</div>

								<!-- Custom Tabs -->
								<div class="w-full tabs-container select-none">
									<div class="relative flex gap-8 border-b border-neutral-100 dark:border-neutral-700 mb-8">
										<button 
											data-tab-btn={`profile-${member.id}`}
											class="tab-btn pb-4 font-bold transition-colors duration-300 focus:outline-none focus-visible:outline-none text-primary-500"
											style="-webkit-tap-highlight-color: transparent;"
										>
											Profile
										</button>
										<button 
											data-tab-btn={`qualifications-${member.id}`}
											class="tab-btn pb-4 font-bold transition-colors duration-300 focus:outline-none focus-visible:outline-none text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300"
											style="-webkit-tap-highlight-color: transparent;"
										>
											Qualifications
										</button>
										<div 
											class="tab-indicator absolute bottom-0 left-0 h-0.5 bg-primary-500 transition-all duration-300 pointer-events-none"
										></div>
									</div>

									<!-- Tabs Content Wrapper -->
									<div class="tabs-content-wrapper">
										<!-- Tab Content: Profile -->
										<div data-tab-content={`profile-${member.id}`} class="tab-content transition-all duration-300 opacity-100">
											<div class="space-y-4 text-neutral-600 dark:text-neutral-400 leading-relaxed text-lg" data-cms-bind={`teamMembers.${index}.profile`}>
												{member.profile.split('\n\n').map((paragraph) => (
													<p set:html={paragraph}></p>
												))}
											</div>
										</div>

										<!-- Tab Content: Qualifications -->
										<div data-tab-content={`qualifications-${member.id}`} class="tab-content transition-all duration-300 opacity-0 pointer-events-none">
											<ul class="grid grid-cols-1 md:grid-cols-2 gap-y-4 gap-x-8" data-cms-bind={`teamMembers.${index}.qualifications`}>
												{member.qualifications.map((qual) => (
													<li class="flex items-start gap-3 text-neutral-600 dark:text-neutral-400 leading-relaxed">
														<Icon name="filled-star" class="w-5 h-5 text-primary-500 mt-1 flex-shrink-0" />
														<span class="text-lg">{qual}</span>
													</li>
												))}
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</Col>
			</Row>
		))}
	</Section>

	<!-- Sister Site Section -->
	<Section id="sister-site" padding="both" classes="bg-neutral-50 dark:bg-neutral-900/50">
		<Row classes="items-center">
			<Col span="6" classes="relative mb-12 lg:mb-0">
				<!-- Image Stack Collage -->
				<div class="relative w-full aspect-square max-w-[500px] mx-auto">
					<!-- Back Image (Top Left) -->
					<div class="absolute top-[5%] left-0 w-[65%] aspect-[4/3] rounded-2xl overflow-hidden shadow-lg transform -rotate-3 z-0">
						<img src="/presentation.jpg" alt="Classroom" class="w-full h-full object-cover" />
					</div>
					<!-- Middle Image (Far Right) -->
					<div class="absolute top-[15%] right-0 w-[60%] aspect-[3/4] rounded-2xl overflow-hidden shadow-xl transform rotate-2 z-10">
						<img src="/acting.jpg" alt="Stage performance" class="w-full h-full object-cover" />
					</div>
					<!-- Front Image (Center Bottom) -->
					<div class="absolute bottom-0 left-[10%] w-[70%] aspect-square rounded-2xl overflow-hidden shadow-2xl border-4 border-white dark:border-neutral-800 transform -rotate-1 z-20">
						<img src="/lady_speaking.png" alt="Communication coaching" class="w-full h-full object-cover" />
					</div>
				</div>
			</Col>
			<Col span="6" classes="lg:pl-12">
				<h2 class="text-4xl lg:text-5xl font-bold text-[#1B008A] dark:text-primary-400 mb-8" data-cms-bind="sisterSiteTitle">
					The Centre Stage Academy
				</h2>
				<div class="space-y-6 text-lg text-neutral-600 dark:text-neutral-400 leading-relaxed" data-cms-bind="sisterSiteDescription">
					<p>
						Founded by Janet Schofield, The Centre Stage Academy, based in Chester, offers expert coaching and tuition for all your speech and communication needs.
					</p>
					<p>
						All of our lessons, classes and courses are tailored to inspire and motivate you, as well as giving you confidence. Whether you are a performer who wishes to improve your acting skills; a professional with a presentation to give; or simply wish to improve your communication skills, we will provide the teaching you need to achieve your goals.
					</p>
				</div>
				<div class="mt-10">
					<Button 
						link="https://thecentrestageacademy.com/" 
						style="primary" 
						size="lg"
					>
						Visit our sister site
					</Button>
				</div>
			</Col>
		</Row>
	</Section>
</Layout>

<script>
	document.addEventListener('astro:page-load', () => {
		const containers = document.querySelectorAll('.tabs-container');

		containers.forEach(container => {
			const tabButtons = container.querySelectorAll('[data-tab-btn]');
			const tabContents = container.querySelectorAll('[data-tab-content]');
			const indicator = container.querySelector('.tab-indicator');

			function updateIndicator(btn: HTMLElement) {
				const ind = indicator as HTMLElement;
				if (!ind) return;
				ind.style.width = `${btn.offsetWidth}px`;
				ind.style.left = `${btn.offsetLeft}px`;
			}

			// Initialize indicator
			const activeBtn = Array.from(tabButtons).find(btn => btn.classList.contains('text-primary-500')) as HTMLElement;
			if (activeBtn) updateIndicator(activeBtn);

			tabButtons.forEach(btnElement => {
				const btn = btnElement as HTMLElement;
				btn.addEventListener('click', () => {
					const target = btn.getAttribute('data-tab-btn');

					// Update indicator
					updateIndicator(btn);

					// Update buttons
					tabButtons.forEach(b => {
						b.classList.remove('text-primary-500');
						b.classList.add('text-neutral-500', 'hover:text-neutral-700', 'dark:hover:text-neutral-300');
					});
					btn.classList.add('text-primary-500');
					btn.classList.remove('text-neutral-500', 'hover:text-neutral-700', 'dark:hover:text-neutral-300');

					// Update content
					tabContents.forEach(content => {
						if (content.getAttribute('data-tab-content') === target) {
							content.classList.add('opacity-100');
							content.classList.remove('opacity-0', 'pointer-events-none');
						} else {
							content.classList.add('opacity-0', 'pointer-events-none');
							content.classList.remove('opacity-100');
						}
					});
				});
			});

			// Handle window resize to keep indicator aligned
			window.addEventListener('resize', () => {
				const currentActiveBtn = Array.from(tabButtons).find(btn => btn.classList.contains('text-primary-500'));
				if (currentActiveBtn instanceof HTMLElement) updateIndicator(currentActiveBtn);
			});
		});
	});
</script>

<style>
	.tabs-content-wrapper {
		display: grid;
		grid-template-columns: 1fr;
	}
	.tab-content {
		grid-area: 1 / 1 / 2 / 2;
	}
</style>
